(library (constraints-tests)
  (export run-constraints-tests)
  (import (chezscheme) (ui) (test-runner) (state) (constraints) (failure) (var) (streams) (package))

  (define (run-constraints-tests)
    (define x0 (make-var 0))
    (define x1 (make-var 1))
    (tassert "disunify always equal" (run* (q) (=/= 1 1)) '())
    (tassert "disunify always disequal" (run* () (=/= 1 2)) '(()))
    (tassert "disunify free-ground" (constraint-disequality (run1 (x0) (=/= x0 0))) (disequality x0 0))
    (tassert "disunify free-free" (map constraint-disequality (run1 (x0 x1) (=/= x0 0) (=/= x1 1)))
	     (list (disequality x0 0) (disequality x1 1)))
    ))
